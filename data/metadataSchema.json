{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://raw.githubusercontent.com/secvisogram/secvisogram/main/data/metadataSchema.json",
  "title": "Field Metadata for CSAF Documents",
  "description": "JSON schema for documentation (specification and usage) on fields of CSAF documents",
  "type": "object",
  "$defs": {
    "relevance_levels_t": {
      "title": "Relevance Levels",
      "description": "Defines the possible relevance levels",
      "type": "string",
      "enum": [
        "mandatory",
        "best_practice",
        "want_to_have",
        "nice_to_know",
        "optional",
        "excluded"
      ]
    },
    "documentation_file_path_t": {
      "title": "File Path",
      "description": "Defines the path to a file on the file system",
      "type": "string",
      "minLength": 1,
      "pattern": "^docs/user(/.+)+-(spec|usage)(-csaf_(base|security_incident_response|informational_advisory|security_advisory|vex))?\\.[a-z]{2,3}\\.md$"
    }
  },
  "required": ["field_metadata"],
  "properties": {
    "field_metadata": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": [
          "path",
          "user_documentation",
          "field_description",
          "field_title"
        ],
        "properties": {
          "path": {
            "title": "Json Path",
            "description": "The JSON path of the field this item holds metadata for",
            "type": "string",
            "minLength": 1,
            "pattern": "^\\$(\\.(([A-Za-z_])+|(cvss_v[23]))(\\[\\])?)+$"
          },
          "relevance_levels": {
            "title": "Relevance Levels",
            "description": "Relevance levels of the field per profile",
            "type": "object",
            "properties": {
              "csaf_base": {
                "title": "CSAF Base Relevance Levels",
                "description": "Relevance Levels for the CSAF Base profile",
                "$ref": "#/$defs/relevance_levels_t"
              },
              "csaf_informational_advisory": {
                "title": "CSAF Informational Advisory Relevance Levels",
                "description": "Relevance Levels for the CSAF Informational Advisory profile",
                "$ref": "#/$defs/relevance_levels_t"
              },
              "csaf_security_advisory": {
                "title": "CSAF Security Advisory Relevance Levels",
                "description": "Relevance Levels for the CSAF Security Advisory profile",
                "$ref": "#/$defs/relevance_levels_t"
              },
              "csaf_security_incident_response": {
                "title": "CSAF Security Incident Relevance Levels",
                "description": "Relevance Levels for the CSAF Security Incident profile",
                "$ref": "#/$defs/relevance_levels_t"
              },
              "csaf_vex": {
                "title": "CSAF VEX Relevance Levels",
                "description": "Relevance Levels for the CSAF VEX profile",
                "$ref": "#/$defs/relevance_levels_t"
              }
            },
            "additionalProperties": false
          },
          "field_description": {
            "title": "Field Description",
            "description": "Description of the field as string key for translation",
            "type": "string",
            "minLength": 1
          },
          "field_title": {
            "title": "Field Label",
            "description": "Label of the field as string key for translation",
            "type": "string",
            "minLength": 1
          },
          "user_documentation": {
            "title": "User Documentation Links",
            "description": "Container for user documentation of the field",
            "type": "object",
            "required": [
              "specification",
              "usage"
            ],
            "properties": {
              "specification": {
                "title": "Specification Link",
                "description": "Link to specification markdown file",
                "$ref": "#/$defs/documentation_file_path_t"
              },
              "usage": {
                "title": "Usage Links",
                "description": "Container for links to usage markdown files",
                "type": "object",
                "required": [
                  "generic"
                ],
                "properties": {
                  "generic": {
                    "title": "Generic User Documentation",
                    "description": "Usage Documentation for the field that applies to all cases",
                    "$ref": "#/$defs/documentation_file_path_t"
                  },
                  "specific": {
                    "title": "Specific User Documentation",
                    "description": "Usage Documentation for the field that applies only in a specific context",
                    "$ref": "#/$defs/documentation_file_path_t"
                  },
                  "csaf_base": {
                    "title": "CSAF Base User Documentation",
                    "description": "Usage Documentation specific to the CSAF Base profile",
                    "$ref": "#/$defs/documentation_file_path_t"
                  },
                  "csaf_informational_advisory": {
                    "title": "CSAF Informational Advisory User Documentation",
                    "description": "Usage Documentation specific to the CSAF Informational Advisory profile",
                    "$ref": "#/$defs/documentation_file_path_t"
                  },
                  "csaf_security_advisory": {
                    "title": "CSAF Security Advisory User Documentation",
                    "description": "Usage Documentation specific to the CSAF Security Advisory profile",
                    "$ref": "#/$defs/documentation_file_path_t"
                  },
                  "csaf_security_incident_response": {
                    "title": "CSAF Security Incident User Documentation",
                    "description": "Usage Documentation specific to the CSAF Security Incident profile",
                    "$ref": "#/$defs/documentation_file_path_t"
                  },
                  "csaf_vex": {
                    "title": "CSAF VEX User Documentation",
                    "description": "Usage Documentation specific to the CSAF VEX profile",
                    "$ref": "#/$defs/documentation_file_path_t"
                  }
                },
                "additionalProperties": false
              },
              "additionalProperties": false
            },
            "additionalProperties": false
          },
          "string_is_multiline": {
            "title": "Multiline String",
            "description": "Defines whether the field content may be multiline string",
            "type": "boolean"
          }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}